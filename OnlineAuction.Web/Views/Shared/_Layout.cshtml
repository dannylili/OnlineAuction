<!DOCTYPE html>
<html>
<head>
    <title>@ViewBag.Title</title>
    <link href="@Url.Content("~/Content/Gray/Base.css")" type="text/css" media="all" rel="Stylesheet" />
    <link href="@Url.Content("~/Content/themes/base/jquery.ui.all.css")" rel="stylesheet" type="text/css" />
    <!--结合属性的requirement做的提示信息要用的js-->
    <script src="../../Scripts/jquery-1.5.1.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/jquery-ui-1.8.11.js")"></script>
    <script src="@Url.Content("~/Scripts/jquery-1.5.1.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/MicrosoftAjax.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/MicrosoftMvcAjax.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/MicrosoftMvcAjax.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery-ui-1.8.11.js")" type="text/javascript"></script>
    <script language="javascript" type="text/jscript">



        $(document).ready(function () {
            try {
                Initial();
                AddAnimate();
            } catch (e) {
                console.log(e.toString());
            }
        });

        /* <!--jquery+mmvc的验证 http://www.cnblogs.com/o2ds/archive/2012/06/27/2565371.html  */
        function Initial() {
            //
            $(":text[data-val-required]").each(function (index, n) {
                var oldClass = $(this).attr("class");
                if (oldClass) {
                    $(this).attr("class", "valid").css("display", "block");

                } else {
                    $(this).attr("class", "valid");
                }
            });

            // 给btnSave按钮添加验证事件
            $("input:submit[class*=BtSave]").each(function (i, n) {
                var element = $(this);
                element.click(Save);
            });

            // 关闭自动填充效果
            $("text textarea").each(function () {
                $(this).attr("completed", "off");
            });

            $(this).removeClass(
            // 为每个autocomplete属性的对象添加搜说功能
            $("input[data-autocomplete-source]").each(function () {
                var target = $(this);
                target.autocomplete({ source: target.attr("data-autocomplete-source") });


                /*------------------------------
                *http://blogs.msdn.com/b/ukadc/archive/2012/04/24/asp-net-mvc-amp-jquery-ui-autocomplete.aspx
                * http://www.google.com.hk/search?hl=zh-CN&newwindow=1&safe=strict&tbo=d&q=mvc3.0+use+jquery+data-autocomplete-source&btnG=Google+%E6%90%9C%E7%B4%A2
                -----------------------------------------------*/

                /*-----------------------------------------------------------------------------*/
            });
        }

        function Save() {
            var messageBody = $("#Uimessage");
            if (messageBody.html() != "") {
                messageBody.html("");
            }

            // window.alert(window.location);

            $(":text[class*='valid']").each(function (i, n) {
                var element = $(n);
                var value = $(n).val();
                var message = element.attr("data-val-required");
                if (value == "") {
                    var str = "<li><div>" + message + "</div></li>";
                    messageBody.append(str);

                    // $("#Uimessage>li").css("list-style-type", "none");
                    $("#Uimessage>li").each(function () {
                        $(this).css("list-style-type", "none");
                    })

                    // 显示验证消息框
                    $("#DivMessage").dialog({
                        modal: true,
                        position: ['right', 'top'],
                        show: true,
                        draggable: true
                    });
                }
            });

        }

        /// 系统内部错误异常信息获取
        window.onerror = customHandler;
        function customHandler(desc, page, line, chr) {
            var windowError = 'JavaScript error occurred! /n'
                    + 'The error was handled by '
                    + 'a customized error handler./n'
                    + '/nError description: /t' + desc
                    + '/nPage address:      /t' + page
                    + '/nLine number:       /t' + line

            alert(windowError);
            return true
        }

        function AddAnimate() {
            // fadeTo方法通过设置匹配元素的透明度opacity淡出
            //            $("#bodyMain").animate({
            //                width: ['toggle', 'swing']
            //            },2000);

            $("#bodyMain").css("opacity", 0.1).fadeTo(3000, 1.0);
        }

        // document.onreadystatechange = PageLoad();
        //        function PageLoad() {

        //            var doucumentLoadStatus = document.readyState;  // http://www.2cto.com/kf/201110/108441.html  // 页面onload=页面所有的元素，script，css加载完毕时出发的事件

        //            if (doucumentLoadStatus == "loading") {
        //                // alert("loading");
        //                $("#ajaxPanel").css.add("display", "block");
        //            }

        //            if (doucumentLoadStatus == "complete") {
        //                $("#ajaxPanel").css.add("display", "none");
        //            }

        //            if (doucumentLoadStatus == "interactive") {
        //                // alert("interactive");
        //                $("#ajaxPanel").css.add("display", "none");
        //            }

        //            if (doucumentLoadStatus == "loaded") {
        //                // alert("loaded");
        //                $("#ajaxPanel").css.add("display", "none");
        //            }
        //        }
    </script>
</head>
<body>
    <div id="bodyMain">
        <div id="top" style="width: 100%; height: auto;">
            @Html.Partial("_Top");
            <!--菜单的搜索框可以参考http://www.apple.com/itunes/affiliates/download/-->
        </div>
        <div id="middle" style="width: 1300px; max-width: 1000px; min-height: 50px; height: auto;
            margin: 0 auto; display: table; padding: 0px; border: 1px solid blue; position: relative;">
            sadfasd
            <div id="layoutLeft" style="width: 150px; position: relative;">
                @Html.Partial("_LayoutLeft");
            </div>
            <div id="layoutMain" style="width: 850px; position: relative;">
                @RenderBody()
                <div id="error">
                </div>
            </div>
            <div id="layoutright" style="width: 300px; position: relative;">
                @Html.Partial("_LayoutRight");
            </div>
        </div>
        <div style="left: 2px; position: absolute;" id="DivMessage">
            <ul id="Uimessage" style="width: 100%; left: 1px;">
            </ul>
        </div>
        <div id="ajaxPanel" style="display: none;">
            <img id="ajaxLoader" src="@Url.Content("~/Content/Gray/Image/ajax-loader.gif")"  title=""/>
        </div>
    </div>
</body>
</html>
